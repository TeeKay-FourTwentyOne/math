# Findings: Peer Review Round 4 — February 11, 2026

## Status: PROOF REMAINS OPEN — but A-flat approach is ALIVE

**CORRECTION**: A-flat D11 DO have valid D12 at p=43. The earlier "all N=0" finding was a
sampling artifact (500K random D12 is insufficient when valid fraction ~1e-7). SA search
found 5/168 A-flat orbits with valid D12. The A-flat conditioning path is viable.

---

## 1. Summary of Investigations

### 1.1 Invariant Hunt (p=19, 23)
- **Result**: The sorted D22 A-profile perfectly determines N(D11) at both primes
- Each N-value group corresponds to exactly one multiplicative orbit under Z_p*
- QR balance is automatic (forced by p ≡ 3 mod 4 symmetry)
- **Implication**: The orbit structure, not scalar summaries, governs validity

### 1.2 Global Flatness Gap
- min_{D11} max_d A(d) - E[A] stays bounded:
  - p=11–47: gap=1 (exact enumeration)
  - p=59–71: gap=2 (sampled)
  - p=79–83: gap=3 (sampled)
- **But globally flat D11 NEVER have N>0** at any tested prime (p=11,19,23)
- Working D11 need asymmetry — low A on D11 positions, higher A on D22

### 1.3 No Simple Scalar Condition (p=31 analysis)
- At p=19, 23: `|Var(A|D11) + Var(A|D22) - 1.93| < T` perfectly separates working/non-working (Goldilocks condition)
- At p=31: **this breaks**. Orbits with identical summary statistics (S_D11, max_A_D22, etc.) have different N values
- **Conclusion**: No single scalar derived from A-values determines N(D11) > 0 for all p

### 1.4 p=31 Orbit Analysis
- 6435 symmetric D11, 429 orbits (all size 15)
- 330 A-flat D11 in 22 orbits
- **6 of 22 A-flat orbits have N > 0** (27%)
- Best orbit: N ≈ 4654 (estimated from 500K D12 samples)
- The full D22 A-profile shape (not just max or variance) determines N

### 1.5 Second Moment Ratio (A-flat D11)
| p | p_working | within-ratio | A-flat ratio | all-D11 ratio |
|---|-----------|-------------|-------------|---------------|
| 11 | 1.000 | 1.00 | 1.0 | 2.0 |
| 19 | 0.333 | 1.00 | 3.0 | 14.0 |
| 23 | 0.571 | 1.69 | 2.95 | 14.5 |
| 31 | 0.273 | 1.87 | ~6.9 | ~134 |

The A-flat ratio grew slowly (1.0, 3.0, 2.95, 6.9), suggesting O(log p) growth — sufficient for the proof if it continued.

### 1.6 ~~CRITICAL: A-flat D11 fail at p=43~~ **CORRECTED: A-flat D11 DO work at p=43**
- p=43: E[A] = 11.0 exactly. A-flat = max_A ≤ 11.
- **3528 A-flat D11 out of 352,716 total (1.0%), 168 orbits**
- ~~ALL A-flat D11 have N=0 (verified with 500K D12 samples per orbit rep)~~
- **CORRECTION**: SA search (80K iterations × 2 trials) found **5/168 A-flat orbits with valid D12** (all max_A=11, sa_cost=0). Verified via ramsey_core.verify_construction.
- The earlier "N=0" finding was a **sampling artifact**: at p=43, valid D12 fraction ~1e-7, so 500K random samples have <5% chance of finding one valid D12 per orbit.
- **p_working(A-flat) ≥ 0.030** at p=43 (SA lower bound; actual value may be higher)
- Known solutions ALSO have max_A=12 (near-flat), confirming both classes work
- The binding slack ≈ E[B] makes A-flat tight but NOT impossible

### 1.7 Near-flat vs A-flat comparison at p=31
| Class | #Orbits | Working | p_working | Ratio |
|-------|---------|---------|-----------|-------|
| A-flat (max_A ≤ 8) | 22 | 6 | 0.273 | 6.86 |
| NF-only (max_A = 9) | 106 | 1 | 0.009 | 106.0 |
| Combined (max_A ≤ 9) | 128 | 7 | 0.055 | 32.67 |

**Conclusion**: A-flat has BETTER ratio (6.86) than near-flat (32.67). Expanding the class dilutes quality.

---

## 2. ~~Why the A-flat Approach Dies~~ The A-flat Slack Analysis

**NOTE: A-flat does NOT die. It is tight but still viable. See Section 1.6 correction.**

The binding slack for A-flat D11 is:
```
slack = (p-3)/2 - floor((p+1)/4) = floor((p-7)/4)
```

The expected B-value is:
```
E[B] = k(k-1)/(p-1) where k = (p-3)/2
     = ((p-3)/2)((p-5)/2)/(p-1)
     = (p-3)(p-5)/(4(p-1))
     ≈ p/4 for large p
```

And slack ≈ (p-7)/4 ≈ p/4 for large p.

So slack ≈ E[B] for all large p. The A-flat constraint leaves zero margin. This isn't a coincidence — it's built into the problem's arithmetic. As p grows, A-flat D11 become impossible to satisfy.

At small primes (p ≤ 31), the O(1) corrections give enough slack. At p=43, they don't.

---

## 3. What Does Work

The known solutions at p=43 have max_A = 12 = E[A] + 1, with specific positions having A(d) above the A-flat threshold. This gives slack = 8 at tight positions but more slack at others.

Define "near-flat" D11: max_{d ∈ D11} A(d) ≤ floor(E[A]) + C for a constant C.

For C=1 ("one above A-flat"):
- p=43: 38,787 D11 with max_A=12 (11% of total). The known solution is in this class.
- p=31: A-flat works with C=0, so C=1 is unnecessary
- p=23: A-flat works with C=0

The second moment argument may work for C=1 (or some bounded C), but we need:
1. Data on the ratio within the max_A ≤ E[A]+1 class at p=43
2. Data at p=47 to confirm the pattern
3. An analytical understanding of why C=1 suffices

---

## 4. Confirmed Structural Results

### Constant z-sum (verified correct)
For all symmetric D11: Σ_{representatives} A(d_i) = n(n-1)/2 (constant). This follows from Parseval and the symmetry A(d) = A(p-d). The sum is over one representative per {d, p-d} pair.

Note: This does NOT imply S_D11 = Σ_{d ∈ D11} A(d) is constant. S_D11 varies across D11 because different D11 "capture" different A-values.

### Ratio decomposition (proven)
```
E[N²]/E[N]² = (1/p_working) × (within-working ratio)
```

The within-working ratio stays near 1 (working D11 have similar N-values). The dominant factor is 1/p_working.

### Orbit structure (proven)
N(D11) is constant on multiplicative orbits of size (p-1)/2.

---

## 5. Open Questions and Next Steps

### 5.1 The Remaining Gap
**State**: For every large prime p ≡ 3 mod 4, prove there exists a symmetric D11 with N(D11) > 0.

**Approach 1: Revised second moment**
- Condition on "near-flat" D11 (max_A ≤ E[A] + C) instead of A-flat
- Need: p_working(C) ≥ 1/poly(p) for some fixed C
- Need: within-working ratio stays poly(p)
- Awaiting p=43, 47 data for the near-flat class

**Approach 2: Algebraic construction**
- Find a specific D11 for each p (defined by character sums, cyclotomic cosets, etc.)
- The Paley construction fails because QR has wrong size for D11
- Need a modification that gives the right size and right A-profile

**Approach 3: Parseval obstruction analysis**
- The reason A-flat fails is the Parseval constraint: Σ B(d) = k(k-1) ≈ (p²/4)
- The per-position slack at A-flat D11 leaves total room ≈ Σ slack(d) which is just barely above k(k-1)
- For near-flat D11, the slack budget increases, creating room
- Can we quantify exactly how much "above flat" is needed?

### 5.2 Proxy Second Moment Ratios (p=43, 47) — COMPLETED

Using marginal-probability-product proxy (treating B-constraints as approximately independent):

| p | ratio_all | ratio_aflat | source |
|---|-----------|-------------|--------|
| 11 | 2.00 | 1.00 | exact |
| 19 | 14.00 | 3.00 | exact |
| 23 | 14.50 | 2.95 | exact |
| 31 | 134.00 | 6.90 | sampled |
| 43 | 92.48 | 6.19 | proxy |
| 47 | 248.64 | 9.02 | proxy |

**Growth**: ratio_all ~ O(p²), ratio_aflat ~ O(p) or slower. Both polynomial — sufficient for Paley-Zygmund.

**Proxy N by max_A class at p=43:**

| max_A | #D11 | mean log2(N_proxy) | best class? |
|-------|------|--------------------|-------------|
| 10-11 (A-flat) | 3528 | -3.6 to -5.1 | N_actual = 0 for all |
| **12 (near-flat)** | **38787** | **+0.5** | **YES — known solution here** |
| 13 | 92022 | -5.3 | some may work |
| 14+ | 218k | << -12 | essentially impossible |

**Caveat**: At p=43, all A-flat D11 have actual N=0, so ratio_aflat=6.19 is proxy-only.
The proxy overestimates the working fraction (gives nonzero where reality gives zero).
Near-flat (max_A=12) ratio from actual N values: **awaiting SA-based computation**.

### 5.3 ~~Near-flat theory~~ CORRECTED: Sign Error + Schur-convexity FALSE

**SIGN ERROR**: The claim f'(0) = 4u²/π > 0 in `proofs/near_flat_theory.md` is WRONG.
By Jensen's inequality on the concave function log Φ(z), the product of marginals ∏Pr[ok_d]
is MAXIMIZED at uniform thresholds (A-flat). Asymmetry HURTS marginals, not helps.

**SCHUR-CONVEXITY CONJECTURE IS FALSE** (verified at p=23). Exact computation of
c₀ = Pr[all ok] / ∏Pr[ok_d] for all 42 orbits at p=23 shows:
- c₀ is NOT monotone in Var(T): Var=1.32 gives c₀=4.48, Var=1.50 gives c₀=0.987
- 4 of 6 majorization pairs violate Schur-convexity
- Correlation(Var(T), c₀) = -0.23 at p=23

**What c₀ actually shows** (exact at p=11,19,23; sampled at p=31):

| p | c₀ range (working) | c₀ mean | Notes |
|---|---------------------|---------|-------|
| 11 | 5.15 | 5.15 | 1 working orbit |
| 19 | 2.59 | 2.59 | 1 working orbit |
| 23 | [0.987, 4.484] | 2.63 | 5 working orbits |
| 31 | [2.80, 16.91] | 8.72 | 7 working orbits |
| 43 | unknown | unknown | N values needed |

Key findings:
1. c₀ = O(poly(p)) — bounded correction factor, not exponentially growing
2. The working/non-working divide is SHARP and ALGEBRAIC — determined by orbit structure
3. c₀ is roughly neutral (≈1-17), neither the engine nor the obstacle
4. No simple scalar condition on the threshold vector separates working from non-working

**Literature**: No existing theorem handles Schur-convexity of orthant probabilities under
negative dependence on fixed-sum hyperplanes. Tong (1982) proves Schur-CONCAVITY for
Schur-concave densities (opposite direction). See `proofs/schur_convexity_literature.md`.

### 5.4 Algebraic Invariant Analysis (Exhaustive)

**Invariants tested**: DFT flatness (max|hat(1_{D11})(k)|²/mean), a_d11_var (variance of A-values
on D11 positions), a_d22_var, a_d22_max, max_A, a_d11_range, character sums, subgroup intersections,
necklace gap/run structure, QR balance.

**Verification**: All orbits at p=31 (429 orbits), all orbits in dataset at p=43 (268 orbits),
plus all orbits at p=11,19,23 from exact data.

#### Single invariants: NONE separates at p ≥ 19
- DFT flatness: 48% false positive rate at p=31
- a_d11_var: 18% false positive rate at p=31
- No single scalar cleanly divides working from non-working

#### Pair invariants:

| Pair | p=11 | p=19 | p=23 | p=31 (429 orbits) | p=43 (268 orbits) |
|------|------|------|------|-----|-----|
| (dft_flatness, a_d11_var) | YES | YES | YES | **YES** | **YES** |
| (dft_flatness, a_d22_var) | YES | YES | YES | **YES** | **YES** |
| (dft_flatness, a_d22_max) | YES | YES | YES | **YES** | **YES** |
| (a_d11_range, dft_flatness) | YES | YES | YES | **YES** | **YES** |
| (a_d11_var, a_d22_var) | YES | YES | YES | 1 overlap | **YES** |
| (a_d22_max, a_d11_var) | YES | YES | YES | 3 overlaps | 3 overlaps |

**The (dft_flatness, a_d11_var) pair separates at all 5 tested primes.** All winning pairs involve DFT flatness.

#### But: the separation boundary is NOT simple
- No linear separator in (flat, var) space — best line has 62 NW false positives at p=31
- Nearest non-working orbits are within distance 0.07 in (flat, var) space
- The boundary is complex (fractal-like), not describable by a simple formula

#### Critical: thresholds are p-dependent

| p | Working flat range | Working var range | Known solution |
|---|---|---|---|
| 11 | [4.11, 4.11] | [0.67, 0.67] | exact |
| 19 | [3.46, 3.46] | [0.56, 0.56] | exact |
| 23 | [2.38, 4.31] | [0.25, 1.33] | exact |
| 31 | [3.31, 5.04] | [0.44, 1.44] | exhaustive |
| 43 | [3.18, 4.76] | [0.81, 1.24] | SA |
| 47 | 3.04 | 2.41 | SA (1 solution) |
| 59 | 2.68 | 3.39 | SA (1 solution) |

**The a_d11_var for SA solutions at p=47 (2.41) and p=59 (3.39) exceed the maximum working
a_d11_var at p=43 (1.24)**. The separation thresholds shift with p. No fixed-constant condition
works across all primes.

Normalized quantities:
- max|hat|²/p ≈ 0.6–1.1 (slowly decreasing with p)
- a_d11_var / Var(A) ≈ 0.15–1.5 (increasing with p, approaching 1 = "random" behavior)
- DFT flatness ≈ 2.7–5.0 (slowly decreasing toward ~1 = perfectly flat)

#### QR-guided construction FAILS
D11 built from pairs {d, p-d} where the smaller element is a QR produces the NON-working
orbit at p=11 and non-working orbits at all tested primes.

### 5.5 Revised Assessment

The proof gap remains: **prove p_working ≥ 1/poly(p) for all large p ≡ 3 mod 4 prime**.

p_working data: {1/2, 1/14, 5/42, 7/429, 6/268} for p = {11, 19, 23, 31, 43}.
p × p_working: {5.5, 1.4, 2.7, 0.51, 0.96} — fluctuates but stays Ω(1).

**What we now know**:
1. The working condition is algebraic (orbit-determined), not statistical
2. No fixed-threshold condition on DFT flatness + A-variance separates across primes
3. DFT power spectrum of 1_{D11} is the fundamental object: A(d) = IDFT(|hat(1_{D11})|²)
4. Working D11 have "intermediate" spectral flatness — not too concentrated, not too flat
5. At larger primes, working D11 approach "random" behavior (a_d11_var → Var(A))

**Remaining proof paths**:

**Path A: Second moment over ALL D11 (unconditional)**
- Ratio E[N²]/E[N]² = O(p²) over all D11 — might be enough?
- If E[N] = Ω(1), then Pr[N>0] ≥ 1/O(p²), and there are Ω(exp(p)) D11, so...
- But Paley-Zygmund doesn't work this way (it's about a single N, not a max)
- Need: E[max_{D11} N(D11)] > 0, which follows from E[N] > 0 (which is trivially true)
- Actually: just need to show Σ_{D11} N(D11) > 0, which follows from E[Σ N(D11)] > 0
- **KEY**: E[Σ_{D11} N(D11)] = (# D11)(# D12) × Pr[valid] — this is HUGE
- The question is not about expectations but about existence

**Path B: Explicit construction**
- Need D11(p) definable for all p ≡ 3 mod 4
- QR-guided fails. Character-sum-based fails (identical spectra for W/NW)
- What remains? Cyclotomic cosets? Kloosterman sums? Lattice constructions?
- The shifting boundary makes this very hard without a structural theory

**Path C: Fourier-analytic approach**
- The DFT connection A(d) = IDFT(|hat(1_{D11})|²) is exact
- Bound N(D11) in terms of the DFT spectrum of 1_{D11}
- Show that "most" D11 with bounded spectral max have N > 0
- This reduces to an additive combinatorics question about Z_p

---

## 5.6 Exact Second Moment at p=31

**COMPUTATION COMPLETE**: Exhaustive enumeration over all 429 symmetric D11 orbits and
all C(31,15) = 300,540,195 D12 candidates per orbit. Runtime: 486 seconds.

### Results

| Quantity | Value |
|----------|-------|
| Total D11 orbits | 429 |
| Working orbits (N > 0) | 18 (4.2%) |
| E[N] | 56.65 |
| E[N²] | 228,669 |
| **E[N²]/E[N]²** | **71.25** |
| PZ lower bound Pr[N>0] | 1.4% |
| Actual Pr[N>0] | 4.2% |

### N values (all 18 working orbits)

N/62: 1, 1, 1, 1, 1, 1, 1, 2, 3, 3, 9, 10, 23, 45, 56, 60, 66, 108

### Key structural discovery: N(D11) is always a multiple of 2p

**Every** N value is an exact multiple of 2p = 62. This is because:
1. **Additive shift invariance**: If D12 is valid for D11, then D12+s = {(x+s) mod p : x ∈ D12}
   is also valid. The B(d) auto-correlations are shift-invariant, and the V1V2 cross-terms
   simply reindex under shifts. This gives a factor of p.
2. **Negation invariance**: If D12 is valid, then -D12 = {(-x) mod p : x ∈ D12} is also valid,
   since D11 = -D11 (symmetric). This gives a factor of 2.

### Cross-prime second moment comparison

| p | Ratio E[N²]/E[N]² | Working/Total | Pr[N>0] |
|---|-------------------|---------------|---------|
| 11 | 2.0 | 2/3 (67%) | 67% |
| 19 | 14.0 | 6/28 (21%) | 21% |
| 23 | 14.5 | 6/42 (14%) | 14% |
| **31** | **71.25** | **18/429 (4.2%)** | **4.2%** |

Growth is erratic (not cleanly polynomial or exponential). The ratio increases roughly
as p^2 to p^4, but with large fluctuations between consecutive primes.

### Implication for the proof

The Paley-Zygmund inequality gives Pr[N > 0] ≥ 1/ratio > 0 for any finite ratio.
The computation confirms ratio = O(poly(p)) at tested primes, supporting the conjecture
that the second moment method can prove existence. However, the exponent (~3-5) means
the bound gets weak quickly: at p=100, ratio might be ~10^8, giving PZ bound ~10^{-8}.

---

## 6. Scripts Created

| File | Purpose |
|------|---------|
| `invariant_hunt.py` | Enumerate A-flat D11, compute all structural data, find invariants |
| `global_flatness.py` | Min-max A(d) across all symmetric D11 |
| `flattest_d11_validity.py` | Check if globally flattest D11 have N > 0 |
| `analyze_condition.py` | Cross-tabulate scalars against N, find separating conditions |
| `p31_orbit_analysis.py` | Full orbit analysis at p=31 with sampled D12 |
| `second_moment_extended.py` | Proxy second moment computation at p=43, 47 |
| `near_flat_analysis.py` | Near-flat SA-based analysis at p=31, 43 |
| `algebraic_invariants.py` | Comprehensive invariant analysis at p=11,19,23 |
| `algebraic_invariants_large.py` | Invariant analysis at p=31,43 |
| `verify_separator.py` | Exhaustive separator verification across all primes |
| `schur_convexity_exact.py` | Exact c₀ computation |
| `c0_estimation.py` | Sampling-based c₀ estimation |
| `spectral_analysis.py` | Full DFT spectrum + spectral complementarity |
| `validate_constraints.py` | Constraint model validation against ramsey_core |
| `exact_N_p31.c` | Exact N(D11) enumeration at p=31 (C program) |

## 7. Key Data Files

| File | Contents |
|------|----------|
| `invariant_hunt_results.json` | Full structural data for p=19, 23 |
| `p31_orbit_results.json` | Orbit analysis for p=31 |
| `second_moment_extended_results.json` | Proxy ratios for p=43, 47 |
| `algebraic_invariants.json` | All invariants for p=11,19,23 |
| `algebraic_invariants_large.json` | All invariants for p=31,43 |
| `schur_convexity_exact.json` | Exact c₀ for all orbits at p=11,19,23 |
| `c0_estimation_results.json` | Sampled c₀ at p=31, marginal CDF at p=31,43 |
| `spectral_analysis_results.json` | DFT spectra for p=43,47,59 |
| `exact_N_p31_results.jsonl` | Exact N for all 429 orbits at p=31 |

## 8. Theory Documents

| File | Contents |
|------|----------|
| `proofs/near_flat_theory.md` | Asymmetric slack + negative correlation argument |
| `proofs/proof_L6_second_moment.md` | Main L6 proof (needs update) |
| `proofs/schur_convexity_literature.md` | Literature review (15 references) |
| `proofs/findings_20260211.md` | This document |
